from django.utils.decorators import method_decorator
from django.views.decorators.cache import cache_page
from django.http import JsonResponse
from django.views import View

class WeatherAPIView(View):
    cache_key = 'weather_data'

    def get_weather_data(self):
        response = requests.get(WEATHER_API_URL, params={"q": CITY, "appid": API_KEY})
        return response.json()

    @method_decorator(cache_page(60 * 20))
    def get(self, request, *args, **kwargs):
        weather_data = self.get_weather_data()
        return JsonResponse(weather_data)